define(["jquery","src/doctrinedata"],function(e,t){function o(e){if(e=="")return;data=e.split("#"),data.length>1024&&console.log("Too many items! Should be 1024. Instead got:"+data.length);var n="",r=0,i=29,s=998,o='{ "map" : [ \n';for(var u=0;u<data.length;u++){if(r>29){i--,r=0;continue}clean_data=data[u].replace(/:.*/g,""),n=t.getCodeKey(clean_data);if(clean_data==s)continue;if(u==512){console.log("skip entrance "+n+" at x:"+r+"y: "+i);continue}i<0&&console.log(n+" does not fit on the map!");if(n=="no-change"){r++;continue}o+='  { "x" : '+r+', "y" : '+i+', "tile" : "'+tile_name+'" },\n',r++}return o=o.slice(0,-2),o+="\n] }\n",o}function u(t,n){var r="empty-floor";return e.each(t,function(e,t){t.trim()==n&&(r=e)}),r}function a(t){try{object=e.parseJSON(t)}catch(n){console.log(n)}return object}var n=function(e){var t='{ "map" : [ \n',n="";for(var r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)n=e[r][i].tile_name,n!="empty-floor"&&(t+='  { "x" : '+i+', "y" : '+r+', "tile" : "'+n+'" },\n');return t=t.slice(0,-2),t+="\n] }\n",t},r=function(e,t){var n="",r="";for(var i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)r=e[i][s].tile_name,n+=t.template[r];n+="\n"}return n},i=function(e){var n="998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#",r="";for(var i=e.length-1;i>=0;i--){for(var s=0;s<e[i].length;s++)r=e[i][s].tile_name,n+=t.getCode(r)+"#",t.getCode(r)===undefined&&console.log(["undefined tile:",r].join(" "));n+=i==15?"998#0#":"998#998#"}return n+="998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998#998",n},s=function(e,t){var n=a(t),r="",i=0,s=0,o='{ "map" : [ \n';for(var f=0;f<e.length;f++){if(e[f]=="\n"){s++,i=0;continue}tile_name=u(n.template,e[f]);if(tile_name=="no-change"){i++;continue}o+='  { "x" : '+i+', "y" : '+s+', "tile" : "'+tile_name+'" },\n',i++}return o=o.slice(0,-2),o+="\n] }\n",o};return{mapToJson:n,mapToDoctrine:i,mapToCustom:r,doctrineToJson:o,customToJson:s,getKey:u}});